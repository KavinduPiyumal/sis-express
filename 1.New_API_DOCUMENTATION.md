---
# Student Information System (SIS) API Documentation

> This document lists all available API endpoints, their request/response details, and cURL examples for each. All endpoints (except register/login/health) require JWT authentication via `Authorization: Bearer <token>`.

---

## Authentication APIs

### Register
**POST** `/api/auth/register`
- **Body:** `{ firstName, lastName, email, password, role, studentId? }`
- **Response:** `201 Created` with user info and token
```bash
curl -X POST http://localhost:3000/api/auth/register \
	-H "Content-Type: application/json" \
	-d '{"firstName":"John","lastName":"Doe","email":"john@example.com","password":"secret123","role":"student"}'
```

### Login
**POST** `/api/auth/login`
- **Body:** `{ email, password }`
- **Response:** `200 OK` with user info and token
# Student Information System (SIS) API Documentation

This document describes all major REST APIs in the SIS backend, including endpoint, method, description, attributes, sample cURL, and example request/response.

---

## Authentication

### Register
- **POST** `/api/auth/register`
- Register a new user (student, admin, super_admin)

**Request Body:**
```json
{
	"firstName": "Kavindu",
	"lastName": "Piyumal",
	"email": "kavindu@uni.lk",
	"password": "password123",
	"role": "student",
	"studentId": "2022/ICT/045"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/auth/register \
	-H "Content-Type: application/json" \
	-d '{"firstName":"Kavindu","lastName":"Piyumal","email":"kavindu@uni.lk","password":"password123","role":"student","studentId":"2022/ICT/045"}'
```

**Success Response:**
```json
{
	"success": true,
	"data": {
		"id": "...",
		"firstName": "Kavindu",
		"lastName": "Piyumal",
		"email": "kavindu@uni.lk",
		"role": "student",
		"studentId": "2022/ICT/045",
		...
	}
}
```

---

### Login
- **POST** `/api/auth/login`
- Authenticate user and get JWT

**Request Body:**
```json
{
	"email": "kavindu@uni.lk",
	"password": "password123"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/auth/login \
	-H "Content-Type: application/json" \
	-d '{"email":"kavindu@uni.lk","password":"password123"}'
```

**Success Response:**
```json
{
	"success": true,
	"token": "<JWT_TOKEN>",
	"user": { ... }
}
```

---

## User Management

### Create User
- **POST** `/api/users`
- Create a new user (admin only)

**Request Body:**
```json
{
	"firstName": "John",
	"lastName": "Doe",
	"email": "john@uni.lk",
	"role": "admin",
	"password": "adminpass"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/users \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"firstName":"John","lastName":"Doe","email":"john@uni.lk","role":"admin","password":"adminpass"}'
```

**Success Response:**
```json
{
	"success": true,
	"data": {
		"id": "...",
		"firstName": "John",
		"lastName": "Doe",
		"email": "john@uni.lk",
		"role": "admin",
		...
	}
}
```

---

### Get User By ID
- **GET** `/api/users/:id`
- Get user details by ID

**cURL:**
```sh
curl -X GET http://localhost:3000/api/users/<userId> \
	-H "Authorization: Bearer <token>"
```

**Success Response:**
```json
{
	"success": true,
	"data": {
		"id": "...",
		"firstName": "John",
		"lastName": "Doe",
		"email": "john@uni.lk",
		"role": "admin",
		...
	}
}
```

---

## Faculty

### Create Faculty
- **POST** `/api/faculties`
- Create a new faculty (super_admin only)

**Request Body:**
```json
{
	"name": "Faculty of Science",
	"deanName": "Prof. Silva",
	"contactInfo": "0123456789"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/faculties \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"name":"Faculty of Science","deanName":"Prof. Silva","contactInfo":"0123456789"}'
```

**Success Response:**
```json
{
	"id": "...",
	"name": "Faculty of Science",
	"deanName": "Prof. Silva",
	"contactInfo": "0123456789",
	...
}
```

---

## Department

### Create Department
- **POST** `/api/departments`
- Create a new department (admin only)

**Request Body:**
```json
{
	"name": "Department of Computer Science",
	"facultyId": "..."
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/departments \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"name":"Department of Computer Science","facultyId":"..."}'
```

**Success Response:**
```json
{
	"id": "...",
	"name": "Department of Computer Science",
	"facultyId": "...",
	...
}
```

---

## Program (DegreeProgram)

### Create Program
- **POST** `/api/programs`
- Create a new degree program (admin only)

**Request Body:**
```json
{
	"name": "BSc in Computer Science",
	"duration": 4,
	"facultyId": "...",
	"departmentId": "..."
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/programs \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"name":"BSc in Computer Science","duration":4,"facultyId":"...","departmentId":"..."}'
```

**Success Response:**
```json
{
	"id": "...",
	"name": "BSc in Computer Science",
	"duration": 4,
	"facultyId": "...",
	"departmentId": "...",
	...
}
```

---

## Batch

### Create Batch
- **POST** `/api/batches`
- Create a new batch (admin only)

**Request Body:**
```json
{
	"name": "2022 Batch",
	"programId": "...",
	"startYear": 2022
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/batches \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"name":"2022 Batch","programId":"...","startYear":2022}'
```

**Success Response:**
```json
{
	"id": "...",
	"name": "2022 Batch",
	"programId": "...",
	"startYear": 2022,
	...
}
```

---

## Semester

### Create Semester
- **POST** `/api/semesters`
- Create a new semester for a batch

**Request Body:**
```json
{
	"name": "Semester 1",
	"batchId": "...",
	"startDate": "2025-01-01",
	"endDate": "2025-06-01"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/semesters \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"name":"Semester 1","batchId":"...","startDate":"2025-01-01","endDate":"2025-06-01"}'
```

**Success Response:**
```json
{
	"id": "...",
	"name": "Semester 1",
	"batchId": "...",
	"startDate": "2025-01-01",
	"endDate": "2025-06-01",
	...
}
```

---

## Subject

### Create Subject
- **POST** `/api/subjects`
- Create a new subject (admin only)

**Request Body:**
```json
{
	"code": "CS101",
	"name": "Intro to Programming",
	"credits": 3,
	"description": "Fundamentals of programming."
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/subjects \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"code":"CS101","name":"Intro to Programming","credits":3,"description":"Fundamentals of programming."}'
```

**Success Response:**
```json
{
	"id": "...",
	"code": "CS101",
	"name": "Intro to Programming",
	"credits": 3,
	"description": "Fundamentals of programming.",
	...
}
```

---

## Course Offering

### Create Course Offering
- **POST** `/api/course-offerings`
- Create a new course offering for a subject in a semester/batch

**Request Body:**
```json
{
	"subjectId": "...",
	"semesterId": "...",
	"batchId": "...",
	"lecturerId": "...",
	"year": 2025,
	"mode": "lecture",
	"capacity": 100
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/course-offerings \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"subjectId":"...","semesterId":"...","batchId":"...","lecturerId":"...","year":2025,"mode":"lecture","capacity":100}'
```

**Success Response:**
```json
{
	"id": "...",
	"subjectId": "...",
	"semesterId": "...",
	"batchId": "...",
	"lecturerId": "...",
	"year": 2025,
	"mode": "lecture",
	"capacity": 100,
	...
}
```

---

## Class Session

### Create Class Session
- **POST** `/api/class-sessions`
- Create a new class session for a course offering

**Request Body:**
```json
{
	"courseOfferingId": "...",
	"date": "2025-02-01T09:00:00Z",
	"topic": "Intro",
	"location": "Room 101",
	"durationMinutes": 90
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/class-sessions \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"courseOfferingId":"...","date":"2025-02-01T09:00:00Z","topic":"Intro","location":"Room 101","durationMinutes":90}'
```

**Success Response:**
```json
{
	"id": "...",
	"courseOfferingId": "...",
	"date": "2025-02-01T09:00:00Z",
	"topic": "Intro",
	"location": "Room 101",
	"durationMinutes": 90,
	...
}
```

---

## Student

### Create Student
- **POST** `/api/students`
- Create a new student (admin only)

**Request Body:**
```json
{
	"userId": "...",
	"studentNo": "2022/ICT/045",
	"fullName": "Kavindu Piyumal",
	"email": "kavindu@uni.lk",
	"batchId": "...",
	"status": "active"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/students \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"userId":"...","studentNo":"2022/ICT/045","fullName":"Kavindu Piyumal","email":"kavindu@uni.lk","batchId":"...","status":"active"}'
```

**Success Response:**
```json
{
	"id": "...",
	"userId": "...",
	"studentNo": "2022/ICT/045",
	"fullName": "Kavindu Piyumal",
	"email": "kavindu@uni.lk",
	"batchId": "...",
	"status": "active",
	...
}
```

---

## Lecturer

### Create Lecturer
- **POST** `/api/lecturers`
- Create a new lecturer (admin only)

**Request Body:**
```json
{
	"userId": "...",
	"fullName": "Dr. Perera",
	"email": "perera@uni.lk",
	"departmentId": "..."
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/lecturers \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"userId":"...","fullName":"Dr. Perera","email":"perera@uni.lk","departmentId":"..."}'
```

**Success Response:**
```json
{
	"id": "...",
	"userId": "...",
	"fullName": "Dr. Perera",
	"email": "perera@uni.lk",
	"departmentId": "...",
	...
}
```

---

## Enrollment

### Enroll Student in Course Offering
- **POST** `/api/enrollments`
- Enroll a student in a course offering (admin only)

**Request Body:**
```json
{
	"studentId": "...",
	"courseOfferingId": "...",
	"status": "active",
	"enrolledDate": "2025-02-01"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/enrollments \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"studentId":"...","courseOfferingId":"...","status":"active","enrolledDate":"2025-02-01"}'
```

**Success Response:**
```json
{
	"id": "...",
	"studentId": "...",
	"courseOfferingId": "...",
	"status": "active",
	"enrolledDate": "2025-02-01",
	...
}
```

---

## Attendance

### Record Attendance
- **POST** `/api/attendances`
- Record attendance for a student in a class session (admin/lecturer only)

**Request Body:**
```json
{
	"studentId": "...",
	"courseOfferingId": "...",
	"classSessionId": "...",
	"status": "present",
	"remarks": "On time"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/attendances \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"studentId":"...","courseOfferingId":"...","classSessionId":"...","status":"present","remarks":"On time"}'
```

**Success Response:**
```json
{
	"id": "...",
	"studentId": "...",
	"courseOfferingId": "...",
	"classSessionId": "...",
	"status": "present",
	"remarks": "On time",
	...
}
```

---

## Medical

### Submit Medical
- **POST** `/api/medicals`
- Submit a medical request (student only)

**Request Body:**
```json
{
	"studentId": "...",
	"submittedDate": "2025-09-21",
	"fromDate": "2025-09-18",
	"toDate": "2025-09-20",
	"reason": "Fever",
	"attachments": ["url-to-pdf"],
	"status": "pending"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/medicals \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"studentId":"...","submittedDate":"2025-09-21","fromDate":"2025-09-18","toDate":"2025-09-20","reason":"Fever","attachments":["url-to-pdf"],"status":"pending"}'
```

**Success Response:**
```json
{
	"id": "...",
	"studentId": "...",
	"submittedDate": "2025-09-21",
	"fromDate": "2025-09-18",
	"toDate": "2025-09-20",
	"reason": "Fever",
	"attachments": ["url-to-pdf"],
	"status": "pending",
	...
}
```

---

## Result

### Enter Result
- **POST** `/api/results`
- Enter a result for a student in a course offering (lecturer/admin only)

**Request Body:**
```json
{
	"studentId": "...",
	"courseOfferingId": "...",
	"marks": 45,
	"grade": "F",
	"gradePoint": 0.0,
	"enteredBy": "...",
	"enteredAt": "2025-05-20"
}
```

**cURL:**
```sh
curl -X POST http://localhost:3000/api/results \
	-H "Authorization: Bearer <token>" \
	-H "Content-Type: application/json" \
	-d '{"studentId":"...","courseOfferingId":"...","marks":45,"grade":"F","gradePoint":0.0,"enteredBy":"...","enteredAt":"2025-05-20"}'
```

**Success Response:**
```json
{
	"id": "...",
	"studentId": "...",
	"courseOfferingId": "...",
	"marks": 45,
	"grade": "F",
	"gradePoint": 0.0,
	"enteredBy": "...",
	"enteredAt": "2025-05-20",
	...
}
```

---

## Error Response Example
```json
{
	"success": false,
	"error": "Validation error: ..."
}
```

---

> **Note:** All endpoints require JWT authentication except `/auth/register` and `/auth/login`. Use `Authorization: Bearer <token>` header.
> All IDs are UUIDs. All dates are ISO8601 strings. All attributes are required unless marked optional.
